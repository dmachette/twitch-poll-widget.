var tmi=(()=>{var oe=Object.defineProperty;var k=(n,e)=>oe(n,"name",{value:e,configurable:!0});var T=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var j=T(()=>{});var q=T((ke,J)=>{var v=class{constructor(){this._events=new Map,this._maxListeners=0}setMaxListeners(e){return this._maxListeners=e,this}emit(e,...s){if(e==="error"&&(!this._events.has("error")||!this._events.get("error").length))throw s[0]instanceof Error?s[0]:TypeError('Uncaught, unspecified "error" event.');let t=this._events.get(e);return t?(t.forEach(i=>i.apply(this,s)),!0):!1}emits(e,s){for(let t=0;t<e.length;t++){let i=t<s.length?s[t]:s[s.length-1];this.emit(e[t],...i)}}on(e,s){this._events.has(e)||this._events.set(e,[]);let t=this._events.get(e);if(this._maxListeners&&t.length>=this._maxListeners)throw Error(`Max listeners exceeded for event '${e}'`);return t.push(s),this}once(e,s){let t=k((...i)=>{this.removeListener(e,t),s(...i)},"onceListener");return this.on(e,t)}off(e,s){let t=this._events.get(e);if(!t)return this;let i=t.indexOf(s);return i===-1?this:(t.splice(i,1),t.length===0&&this._events.delete(e),this)}removeAllListeners(e){return e?this._events.delete(e):this._events.clear(),this}listeners(e){return this._events.get(e)||[]}listenerCount(e){return this._events.get(e)?this._events.get(e).length:0}};k(v,"EventEmitter");v.prototype.addListener=v.prototype.on;v.prototype.removeListener=v.prototype.off;v.EventEmitter=v;v.defaultMaxListeners=10;J.exports=v});var G=T((Ce,H)=>{var L=class{constructor(){this._levels={trace:0,debug:1,info:2,warn:3,error:4,fatal:5},this._currentLevel="error"}_log(e,s){if(this._levels[e]<this._levels[this._currentLevel])return;let t=new Date,i=t.getHours(),o=t.getMinutes(),h=`${(i<10?"0":"")+i}:${(o<10?"0":"")+o}`;console.log(`[${h}] ${e}: ${s}`)}setLevel(e){this._currentLevel=e}getLevel(){return this._currentLevel}trace(e){this._log("trace",e)}debug(e){this._log("debug",e)}info(e){this._log("info",e)}warn(e){this._log("warn",e)}error(e){this._log("error",e)}fatal(e){this._log("fatal",e)}};k(L,"Logger");H.exports=L});var M=T(($e,F)=>{var ne=/^\u0001ACTION ([^\u0001]+)\u0001$/,re=/^(justinfan)(\d+$)/,ae=/\\([sn:r\\])/g,ce=/([ \n;\r\\])/g,le=/^oauth:/i,V={s:" ",n:"",":":";",r:""},W={" ":"s","\n":"n",";":":","\r":"r"},he=F.exports={hasOwn:(n,e)=>({}).hasOwnProperty.call(n,e),promiseDelay:n=>new Promise(e=>setTimeout(e,n)),isInteger(n){return typeof n!="string"&&typeof n!="number"?!1:!isNaN(Math.round(n))},justinfan:()=>`justinfan${Math.floor(Math.random()*8e4+1e3)}`,isJustinfan:n=>re.test(n),channel(n){let e=(n||"").toLowerCase();return e[0]==="#"?e:`#${e}`},username(n){let e=(n||"").toLowerCase();return e[0]==="#"?e.slice(1):e},token:n=>n?n.replace(le,""):"",password(n){let e=he.token(n);return e?`oauth:${e}`:""},actionMessage:n=>n.match(ne),unescapeHtml:n=>n.replace(/\\&amp\\;/g,"&").replace(/\\&lt\\;/g,"<").replace(/\\&gt\\;/g,">").replace(/\\&quot\\;/g,'"').replace(/\\&#039\\;/g,"'"),unescapeIRC(n){return!n||typeof n!="string"||!n.includes("\\")?n:n.replace(ae,(e,s)=>s in V?V[s]:s)},escapeIRC(n){return!n||typeof n!="string"?n:n.replace(ce,(e,s)=>s in W?`\\${W[s]}`:s)},inherits(n,e){n.super_=e;let s=k(function(){},"TempCtor");s.prototype=e.prototype,n.prototype=new s,n.prototype.constructor=n}}});var z=T((ve,B)=>{var N=M(),E=/\S+/g;function D(n,e,s=",",t="/",i){let o=n[e];if(o===void 0)return n;let h=typeof o=="string";if(n[`${e}-raw`]=h?o:null,o===!0)return n[e]=null,n;if(n[e]={},h){let u=o.split(s);for(let b=0;b<u.length;b++){let w=u[b].split(t),[,C]=w;i!==void 0&&C&&(C=C.split(i)),n[e][w[0]]=C||null}}return n}k(D,"parseComplexTag");B.exports={badges:n=>D(n,"badges"),badgeInfo:n=>D(n,"badge-info"),emotes:n=>D(n,"emotes","/",":",","),emoteRegex(n,e,s,t){E.lastIndex=0;let i=new RegExp(`(\\b|^|\\s)${N.unescapeHtml(e)}(\\b|$|\\s)`),o;for(;(o=E.exec(n))!==null;)i.test(o[0])&&(t[s]=t[s]||[],t[s].push([o.index,E.lastIndex-1]))},emoteString(n,e,s,t){E.lastIndex=0;let i;for(;(i=E.exec(n))!==null;)i[0]===N.unescapeHtml(e)&&(t[s]=t[s]||[],t[s].push([i.index,E.lastIndex-1]))},transformEmotes(n){let e="";return Object.keys(n).forEach(s=>{e=`${e}${s}:`,n[s].forEach(t=>e=`${e}${t.join("-")},`),e=`${e.slice(0,-1)}/`}),e.slice(0,-1)},formTags(n={}){let e=Object.entries(n).map(([s,t])=>`${N.escapeIRC(s)}=${N.escapeIRC(t)}`);return e.length?`@${e.join(";")}`:null},msg(n){let e={raw:n,tags:{},prefix:null,command:null,params:[]},s=0,t=0;if(n.charCodeAt(0)===64){if(t=n.indexOf(" "),t===-1)return null;let i=n.slice(1,t).split(";");for(let o=0;o<i.length;o++){let h=i[o],u=h.split("=");e.tags[u[0]]=h.slice(h.indexOf("=")+1)||!0}s=t+1}for(;n.charCodeAt(s)===32;)s++;if(n.charCodeAt(s)===58){if(t=n.indexOf(" ",s),t===-1)return null;for(e.prefix=n.slice(s+1,t),s=t+1;n.charCodeAt(s)===32;)s++}if(t=n.indexOf(" ",s),t===-1)return n.length>s?(e.command=n.slice(s),e):null;for(e.command=n.slice(s,t),s=t+1;n.charCodeAt(s)===32;)s++;for(;s<n.length;){if(t=n.indexOf(" ",s),n.charCodeAt(s)===58){e.params.push(n.slice(s+1));break}if(t!==-1){for(e.params.push(n.slice(s,t)),s=t+1;n.charCodeAt(s)===32;)s++;continue}if(t===-1){e.params.push(n.slice(s));break}}return e}}});var X=T((xe,Q)=>{var A=class{constructor(e){this.queue=[],this.index=0,this.defaultDelay=e===void 0?3e3:e}add(e,s){this.queue.push({fn:e,delay:s})}next(){let e=this.index++,s=this.queue[e];if(!s)return;let t=this.queue[this.index];if(s.fn(),t){let i=t.delay===void 0?this.defaultDelay:t.delay;setTimeout(()=>this.next(),i)}}};k(A,"Queue");Q.exports=A});var K=T((Te,Z)=>{var me=typeof global!="undefined"?global:typeof window!="undefined"?window:{},Y,ue=(Y=me.WebSocket)!=null?Y:j(),pe=q(),fe=G(),R=z(),de=X(),m=M(),P=class extends pe{constructor(e){var s,t,i,o,h,u,b,w,C,x,S,O,r,a;super(),this.opts=e!=null?e:{},this.opts.channels=(s=this.opts.channels)!=null?s:[],this.opts.connection=(t=this.opts.connection)!=null?t:{},this.opts.identity=(i=this.opts.identity)!=null?i:{},this.opts.options=(o=this.opts.options)!=null?o:{},this.clientId=(h=this.opts.options.clientId)!=null?h:null,this._globalDefaultChannel=m.channel((u=this.opts.options.globalDefaultChannel)!=null?u:"#tmijs"),this._skipMembership=(b=this.opts.options.skipMembership)!=null?b:!1,this.maxReconnectAttempts=(w=this.opts.connection.maxReconnectAttempts)!=null?w:1/0,this.maxReconnectInterval=(C=this.opts.connection.maxReconnectInterval)!=null?C:3e4,this.reconnect=(x=this.opts.connection.reconnect)!=null?x:!0,this.reconnectDecay=(S=this.opts.connection.reconnectDecay)!=null?S:1.5,this.reconnectInterval=(O=this.opts.connection.reconnectInterval)!=null?O:1e3,this.reconnecting=!1,this.reconnections=0,this.reconnectTimer=this.reconnectInterval,this.currentLatency=0,this.latency=new Date,this.secure=(r=this.opts.connection.secure)!=null?r:!this.opts.connection.server&&!this.opts.connection.port,this.pingLoop=null,this.pingTimeout=null,this.wasCloseCalled=!1,this.reason="",this.ws=null,this.emotes="",this.emotesets={},this.username="",this.channels=[],this.globaluserstate={},this.userstate={},this.lastJoined="",this.moderators={},this.log=(a=this.opts.logger)!=null?a:new fe;try{this.log.setLevel(this.opts.options.debug?"info":"error")}catch(p){}this.opts.channels.forEach((p,f,_)=>_[f]=m.channel(p)),this.setMaxListeners(0)}api(){throw new Error("The Client.api() method has been removed.")}handleMessage(e){var h,u,b,w,C,x,S,O;if(!e)return;this.listenerCount("raw_message")&&this.emit("raw_message",JSON.parse(JSON.stringify(e)),e);let s=m.channel((h=e.params[0])!=null?h:null),t=(u=e.params[1])!=null?u:null,i=(b=e.tags["msg-id"])!=null?b:null,o=e.tags=R.badges(R.badgeInfo(R.emotes(e.tags)));for(let r in o){if(r==="emote-sets"||r==="ban-duration"||r==="bits")continue;let a=o[r];typeof a=="boolean"?a=null:a==="1"?a=!0:a==="0"?a=!1:typeof a=="string"&&(a=m.unescapeIRC(a)),o[r]=a}if(e.prefix===null)switch(e.command){case"PING":this.emit("ping"),this._isConnected()&&this.ws.send("PONG");break;case"PONG":{this.currentLatency=(new Date().getTime()-this.latency.getTime())/1e3,this.emits(["pong","_promisePing"],[[this.currentLatency]]),clearTimeout(this.pingTimeout);break}default:this.log.warn(`Could not parse message with no prefix:
